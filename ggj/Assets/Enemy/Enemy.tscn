[gd_scene load_steps=17 format=3 uid="uid://b8rkaqsio0tvb"]

[ext_resource type="Script" path="res://Assets/Enemy/Enemy.cs" id="1_ekytm"]
[ext_resource type="Texture2D" uid="uid://ddnol13543xqu" path="res://Assets/Enemy/sceriffo_1.png" id="2_s7rih"]
[ext_resource type="PackedScene" uid="uid://d0lqrxraktaya" path="res://Assets/Gun/EnemyGun.tscn" id="3_1h57y"]

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_kubvp"]
radius = 24.0
height = 72.0

[sub_resource type="Animation" id="Animation_uk0ju"]
resource_name = "Down"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("EnemyGun:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(0, -55)]
}

[sub_resource type="Animation" id="Animation_6nrhc"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("EnemyGun:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(0, -55)]
}

[sub_resource type="Animation" id="Animation_tu467"]
resource_name = "Left"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("EnemyGun:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(-30.035, -55)]
}

[sub_resource type="Animation" id="Animation_jqnuv"]
resource_name = "Right"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("EnemyGun:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(30.67, -55)]
}

[sub_resource type="Animation" id="Animation_aubp3"]
resource_name = "Up"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("EnemyGun:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(0, -56.42)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_awoth"]
_data = {
"Down": SubResource("Animation_uk0ju"),
"Left": SubResource("Animation_tu467"),
"RESET": SubResource("Animation_6nrhc"),
"Right": SubResource("Animation_jqnuv"),
"Up": SubResource("Animation_aubp3")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_itf1i"]
animation = &"Down"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_npptn"]
animation = &"Up"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_3fkyy"]
animation = &"Right"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_5t3k1"]
animation = &"Left"

[sub_resource type="AnimationNodeBlendSpace2D" id="AnimationNodeBlendSpace2D_51v8l"]
blend_point_0/node = SubResource("AnimationNodeAnimation_itf1i")
blend_point_0/pos = Vector2(0, 1)
blend_point_1/node = SubResource("AnimationNodeAnimation_npptn")
blend_point_1/pos = Vector2(0, -1)
blend_point_2/node = SubResource("AnimationNodeAnimation_3fkyy")
blend_point_2/pos = Vector2(0.9, 0)
blend_point_3/node = SubResource("AnimationNodeAnimation_5t3k1")
blend_point_3/pos = Vector2(-0.9, 0)
blend_mode = 1

[sub_resource type="CircleShape2D" id="CircleShape2D_p5lpe"]
radius = 1107.0

[node name="Enemy" type="CharacterBody2D" node_paths=PackedStringArray("animTree", "gun", "timeBetweenShootTimer", "attackSubStateTimer")]
collision_layer = 8
collision_mask = 133
script = ExtResource("1_ekytm")
animTree = NodePath("AnimationTree")
gun = NodePath("EnemyGun")
timeBetweenShootTimer = NodePath("ShootTimer")
attackSubStateTimer = NodePath("AttackSubStateTimer")
shootRange = 800.0

[node name="Sprite2D" type="Sprite2D" parent="."]
scale = Vector2(0.25, 0.25)
texture = ExtResource("2_s7rih")
offset = Vector2(0, -380)

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(0, -6)
rotation = 1.5708
shape = SubResource("CapsuleShape2D_kubvp")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_awoth")
}

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource("AnimationNodeBlendSpace2D_51v8l")
anim_player = NodePath("../AnimationPlayer")
parameters/blend_position = Vector2(0, 0)

[node name="EnemyGun" parent="." instance=ExtResource("3_1h57y")]
position = Vector2(0, -55)

[node name="ShootTimer" type="Timer" parent="."]
wait_time = 0.4
one_shot = true

[node name="AttackSubStateTimer" type="Timer" parent="."]
one_shot = true

[node name="DetectPlayerArea2D" type="Area2D" parent="."]
collision_layer = 0
collision_mask = 2

[node name="CollisionShape2D" type="CollisionShape2D" parent="DetectPlayerArea2D"]
shape = SubResource("CircleShape2D_p5lpe")

[connection signal="timeout" from="ShootTimer" to="." method="ShootWaitTimeout"]
[connection signal="timeout" from="AttackSubStateTimer" to="." method="AttackSubStateTimerTimeout"]
[connection signal="body_entered" from="DetectPlayerArea2D" to="." method="Area2DBodyEntered"]
[connection signal="body_exited" from="DetectPlayerArea2D" to="." method="Area2DBodyExited"]
